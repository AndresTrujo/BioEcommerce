{% extends 'base.html' %}
{% load static %}

{% block title %}
  {{ product.PROD_NOMBRE }}
{% endblock %}
<!-- Boxicons here -->
{% block styles %}
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
{% endblock %}

{% block content %}
  <!-- btn return start -->
  <div class="flex items-center pl-5 mt-20">
    <div class="btn">
      <a href="{% url 'products:landing_page' %}"><img class="w-5" src="{% static 'img/arrow-left.svg' %}" alt="" /></a>
    </div>
    <div class="pb-1 pl-2">
      <a href="{% url 'products:landing_page' %}">Regresar</a>
    </div>
  </div>
  <!-- btn return end -->

  <!-- product detail start -->
  <div class="w-screen px-5 mt-20 flex flex-col gap-5 | lg:flex-row">
    <div class="left lg:w-1/2 flex justify-center items-center">
      <!-- Imagen de prod -->
      {% if product.PROD_IMAGEN %}
        <img src="{{ product.PROD_IMAGEN.url }}" alt="{{ product.PROD_NOMBRE }}" srcset="" />
      {% else %}
        <img src="{% static '/img/citrato.png' %}" alt="" />
      {% endif %}
    </div>
    <div class="right lg:w-1/2">
      <!-- Nombre del producto -->
      <h3 class="text-2xl | sm:text-4xl | md:text-5xl | lg:text-4xl">{{ product.PROD_NOMBRE }}</h3>
      <!-- Gramaje o contenid del producto -->
      <p class="text-md mt-1 | sm:text-lg | md:text-sm">{{ product.PROD_GRAMAJE }} mg</p>
      <!-- Descripción corta del producto -->
      <p class="text-md mt-1 | sm:text-lg | md:text-sm">{{ product.CONTENIDO_PZS }}</p>
      <div class="precio flex items-center gap-2 mt-5 mb-2">
        <!-- Precio del producto -->
        <p class="text-lg font-bold | sm:text-2xl |">${{ product.PROD_PRECIO_PUB }}</p>
      </div>
      <hr />
      <!-- Variante del producto -->
      <!-- Variante cambia dependiendo el tipo de producto -->
      <p class="text-md mt-10">Cápsulas:</p>
      <div class="selector inline-flex space-x-2 mt-5">
        <label class="relative">
          <input type="radio" name="capsulas" value="60" class="peer sr-only" />
          <!-- opcion del selector que aparece en navegador -->
          <span class="px-4 py-1 bg-[#D9D9D9] text-black transition cursor-pointer peer-checked:bg-white peer-checked:border-b-3">{{ product.CONTENIDO_PZS }}</span>
        </label>
      </div>
      <div class="w-full h-15 mt-5 flex gap-1 | sm:h-11 sm:gap-2">
        <!-- Contador de num de productos -->
        <div class="w-1/2 border border-[#9E9E9E] border-2 | sm:w-1/5"></div>
        <!-- Add to shopping car btn -->
        <!-- Se desplegará carrito de compras -->
        <a href="#" class="w-1/2 border bg-black text-white flex items-center justify-center transition hover:bg-[#686868] | sm:w-4/5">Añadir al carrito</a>
      </div>
      <div class="w-full mt-2 flex">
        <!-- btn que dirigirá al checkout -->
        <form action="{% url 'cart:cart_add' product.ID_PRODUCTO %}" method="post" id="add-to-cart-form" class="w-full h-15 sm:h-11">
          {% csrf_token %}
          <button type="submit" class="w-full h-15 sm:h-11 bg-[#0D00BD] flex justify-center items-center text-white">Comprar ahora</button>
          <p id="message"></p>
        </form>
      </div>

      <!-- acordion -->
      <div className="acordion-container ">
        <div class="accordion-header mt-10 flex items-center justify-between text-[#6D6D6D] cursor-pointer">
          <span class="font-semibold text-xl">Detalles</span>
          <i class="bx bx-chevron-down"></i>
        </div>
        <div class="accordion-body border-t-2 border-[#6D6D6D] max-h-0 overflow-hidden transition-all duration-200 ease-out">
          <div class="p-2 [&>ul>li]:text-[#6D6D6D]">
            <!-- Detalle de producto > Cada punto se pone dentro del "li" -->
            <ul>
              <li>Presentacion: {{ product.PROD_DESCRIPCION }}</li>
            </ul>
          </div>
        </div>
        <div class="accordion-header mt-10 flex items-center justify-between text-[#6D6D6D] cursor-pointer">
          <span class="font-semibold text-xl">Envíos</span>
          <i class="bx bx-chevron-down"></i>
        </div>
        <div class="accordion-body max-h-0 overflow-hidden transition-all duration-200 ease-out">
          <div class="p-2 [&>ul>li]:text-[#6D6D6D]">
            <ul></ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- product detail end -->
  <!-- Reseñas start -->
  <div class="reseñas-container w-screen px-5 mt-20">
    <p class="text-md text-[#6D6D6D] text-center">Reseñas</p>
    <h3 class="text-center text-xl font-semibold">Lo que nuestros usuarios dicen</h3>
    <!-- Reseña container > aqui se despliegan todas las reseñas -->
    <div class="slider-container mt-10 flex gap-2 lg:px-10">
      <!-- Reseña 1 -->
      <div class="reseña-card border-2 border-[#6D6D6D] w-full">
        <div class="content p-4 flex flex-col">
          <!-- Nombre cliente -->
          <h3>Luis venegas</h3>
          <p class="flex items-center gap-2">
            <!-- Calificacion cliente -->
            <i class="bx bxs-star"></i>4.5/5.0 Estrellas
          </p>
          <!-- Reseña cliente -->
          <p class="p-2">Reseña del cliente</p>
        </div>
      </div>
      <!-- Reseña 2 -->
      <div class="reseña-card hidden sm:flex border-2 border-[#6D6D6D] w-full">
        <div class="content p-4 flex flex-col">
          <h3>Luis venegas</h3>
          <p class="flex items-center gap-2">
            <i class="bx bxs-star"></i>4.5/5.0 Estrellas
          </p>
          <p class="p-2">Reseña del cliente</p>
        </div>
      </div>
      <!-- Reseña 3 -->
      <div class="reseña-card hidden xl:flex border-2 border-[#6D6D6D] w-full">
        <div class="content p-4 flex flex-col">
          <h3>Luis venegas</h3>
          <p class="flex items-center gap-2">
            <i class="bx bxs-star"></i>4.5/5.0 Estrellas
          </p>
          <p class="p-2">Reseña del cliente</p>
        </div>
      </div>
    </div>
  </div>
  <!-- Reseñas end -->
  <!-- Prod sugerencias start -->
  <div class="prod-sugerencias-container w-screen px-5 mt-20">
    <p class="text-md text-[#6D6D6D] text-center">Productos sugeridos</p>
    <h3 class="text-center text-xl font-semibold">Te puede interesar</h3>
    <div class="prod-suger mt-10 flex flex-col gap-2 items-center justify-center | lg:flex-row lg:gap-5 lg:px-10">
      {% for producto in lista_productos %}
        <div class="prod-suger-card w-full | sm:w-100">
          <div class="content p-4 flex flex-col">
            <!-- Imagen producto -->
            <div class="border-2 border-[#6D6D6D] rounded-sm">
              <img src="{% static 'assets/img/pre-workout.png' %}" alt="" />
            </div>
            <!-- Nombre producto -->
            <h3>{{ product.PROD_NOMBRE }} {{ product.PROD_GRAMAJE }}</h3>
            <!-- Precio producto -->
            <p class="text-lg font-bold">{{ product.PROD_PRECIO_PUB }}</p>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
  <!-- Prod sugerencias end -->
{% endblock %}

{% block scriptsJS %}
{% comment %}   <script>
    document.getElementById('add-to-cart-form').addEventListener('submit', function (event) {
      event.preventDefault()
      const form = event.target
      const url = form.action
      const formData = new FormData(form)
      fetch(url, {
        method: 'POST',
        body: formData,
        headers: {
          'X-CSRFToken': formData.get('csrfmiddlewaretoken')
        }
      })
        .then((response) => response.json())
        .then((data) => {
          console.log(data);
          const messageElement = document.getElementById('message')
          if (data.success) {
            messageElement.textContent = data
          } else {
            messageElement.textContent = 'Error al añadir el producto al carrito.'
          }
        })
        .catch((error) => {
          console.error('Error:', error)
          document.getElementById('message').innerText = 'Error al añadir el producto al carrito.'
        })
      document.getElementById('message').innerText = 'Producto añadido al carrito exitosamente.'
    })
  </script>

  <script>
    const accordionHeader = document.querySelectorAll('.accordion-header')
    accordionHeader.forEach((accordionHeader) => {
      accordionHeader.addEventListener('click', (event) => {
        accordionHeader.classList.toggle('active')
        const accordionBody = accordionHeader.nextElementSibling
        if (accordionHeader.classList.contains('active')) {
          accordionBody.style.maxHeight = accordionBody.scrollHeight + 'px'
        } else {
          accordionBody.style.maxHeight = 0
        }
      })
    })
  </script>
 {% endcomment %}
{% comment %}   <script>
    const botonesCapsulas = document.querySelectorAll('.selector-capsulas button')
    const imagenProducto = document.getElementById('imagen-producto')
    const nombreProducto = document.getElementById('nombre-producto')
    const precioProducto = document.getElementById('precio-producto')
    
    let menuMobile = document.getElementById('menu-mobile')
    let ham_menu = document.getElementById('ham_menu')
    
    menuMobile.addEventListener('click', function () {
      ham_menu.classList.toggle('hidden')
    })
  </script> {% endcomment %}
{% endblock %}
